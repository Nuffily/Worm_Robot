package gui;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.ArrayList;
import java.util.InvalidPropertiesFormatException;
import java.util.Properties;
import java.util.Set;

public class WindowsPosition {
	private final String filename = System.getProperty("user.home") +
			System.getProperty("file.separator") + "robot_settings.xml";
    
	// create properties
	public Properties createProperties(ArrayList<PositionedWindow> windows) 
    {
    	Properties pr = new Properties();
    	for (PositionedWindow w : windows) 
    	{
    		Properties pWindow = w.getPosition();
    		Set<String> keys = pWindow.stringPropertyNames();
    	    for (String key : keys) {
    	      pr.setProperty(key, pWindow.getProperty(key));
    	    }
    	}
    	return pr;
    }
	
	// save windows settings
    public void savePositionToFile(Properties pr) 
    {
    	// save to file
    	try {
			OutputStream os = new FileOutputStream(filename);
			pr.storeToXML(os, null);
			os.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
    }
    
    // read properties from file
    public Properties readPositionFromFile()
    {
    	// try open file and load properties
    	InputStream is;
    	Properties pr = new Properties();
    	try {
			is = new FileInputStream(filename);
			pr.loadFromXML(is);
			is.close();
		} catch (FileNotFoundException e) {
			// do nothing in case of exceptions
			return null;
		} catch (InvalidPropertiesFormatException e) {
			return null;
		} catch (IOException e) {
			return null;
		}
    	return pr;
    }
    
    // restore windows settings
    public void restorePosition(Properties pr, ArrayList<PositionedWindow> windows)
    {
    	if (pr == null) 
    	{
    		return;
    	}
    	for (PositionedWindow w : windows) 
    	{
    		w.restorePosition(pr);
    	}
    }
}
